<!DOCTYPE html>
<html lang="en"><!-- Mirrored from www.slimframework.com/docs/v3/features/csrf.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jun 2019 12:43:44 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

        <meta charset="utf-8"/>
        <meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport"/>
        <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
        <title>CSRF Protection - Slim Framework</title>
        <meta content="" name="description"/>
        <meta content="index, follow" name="robots"/>
        <meta content="CSRF Protection" property="og:title"/>
        <meta content="Slim Framework" property="og:site_name"/>
        <meta content="csrf.html" property="og:url"/>
        <meta content="" property="og:description"/>
        <meta content="website" property="og:type"/>
        <!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
        <link href="../../../assets/css/all.css" rel="stylesheet"/>
        <link href="../../../assets/images/favicon.png" rel="shortcut icon"/>
        <link href="../../../../maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
        
        
        
    </head>
    <body style="padding-top: 5em">
        

<div class="wrapper docs">
    <div class="container-fluid">
        

        <div class="row">
            

            <div class="col-md-8 docs-content">
                <h1 class="page-header"><a class="dashAnchor" name="//apple_ref/cpp/Section/CSRF%20Protection"></a>CSRF Protection</h1>
                <div class="edit-panel" style="margin: 0 0 1em 0;">
                    <a class="btn btn-default btn-sm" href="https://github.com/slimphp/Slim-Website/tree/gh-pages/docs/v3/features/csrf.md" role="button" target="_blank"><i class="fa fa-github"></i> Edit This Page</a>
                    
                </div>
                <p>Slim 3 uses the optional standalone <a href="https://github.com/slimphp/Slim-Csrf">slimphp/Slim-Csrf</a>
PHP component to protect your application from CSRF (cross-site request forgery).
This component generates a unique token per request that validates subsequent
POST requests from client-side HTML forms.</p>

<h2 id="installation"><a class="dashAnchor" name="//apple_ref/cpp/Section/Installation"></a>Installation</h2>

<p>Execute this bash command from your project’s root directory:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>composer require slim/csrf
</code></pre></div></div>

<h2 id="usage"><a class="dashAnchor" name="//apple_ref/cpp/Section/Usage"></a>Usage</h2>

<p>The <code class="highlighter-rouge">slimphp/Slim-Csrf</code> component contains an application middleware. Add it
to your application like this:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Add middleware to the application
</span><span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Slim\App</span><span class="p">;</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">\Slim\Csrf\Guard</span><span class="p">);</span>

<span class="c1">// Create your application routes...
</span>
<span class="c1">// Run application
</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span>
</code></pre></div></div>

<h2 id="fetch-the-csrf-token-name-and-value"><a class="dashAnchor" name="//apple_ref/cpp/Section/Fetch%20the%20CSRF%20token%20name%20and%20value"></a>Fetch the CSRF token name and value</h2>

<p>The latest CSRF token’s name and value are available as attributes on the
PSR7 request object. The CSRF token name and value are unique for each request.
You can fetch the current CSRF token name and value like this.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/foo'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="nv">$res</span><span class="p">,</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// CSRF token name and value
</span>    <span class="nv">$nameKey</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">csrf</span><span class="o">-&gt;</span><span class="na">getTokenNameKey</span><span class="p">();</span>
    <span class="nv">$valueKey</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">csrf</span><span class="o">-&gt;</span><span class="na">getTokenValueKey</span><span class="p">();</span>
    <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$req</span><span class="o">-&gt;</span><span class="na">getAttribute</span><span class="p">(</span><span class="nv">$nameKey</span><span class="p">);</span>
    <span class="nv">$value</span> <span class="o">=</span> <span class="nv">$req</span><span class="o">-&gt;</span><span class="na">getAttribute</span><span class="p">(</span><span class="nv">$valueKey</span><span class="p">);</span>

    <span class="c1">// Render HTML form which POSTs to /bar with two hidden input fields for the
</span>    <span class="c1">// name and value:
</span>    <span class="c1">// &lt;input type="hidden" name="&lt;?= $nameKey ?&gt;" value="&lt;?= $name ?&gt;"&gt;
</span>    <span class="c1">// &lt;input type="hidden" name="&lt;?= $valueKey ?&gt;" value="&lt;?= $value ?&gt;"&gt;
</span><span class="p">});</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">'/bar'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="nv">$res</span><span class="p">,</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// CSRF protection successful if you reached
</span>    <span class="c1">// this far.
</span><span class="p">});</span>
</code></pre></div></div>

<p>You should pass the CSRF token name and value to the template so they
may be submitted with HTML form POST requests. They are often stored as a hidden
field with HTML forms.</p>

<p>For more use cases and documentation please check <a href="https://github.com/slimphp/Slim-Csrf">slimphp/Slim-Csrf</a>’s page.</p>


                <nav>
                    <ul class="nav pager">
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                
                                    
                                        <li class="previous">
                                            <a href="caching.html" rel="prev"><i class="fa fa-arrow-left"></i> <small>Add Ons: </small> HTTP Caching</a>
                                        </li>
                                    
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                
                                    <li class="next">
                                        <a href="flash.html" rel="next"><small>Add Ons: </small> Flash Messages <i class="fa fa-arrow-right"></i></a>
                                    </li>
                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                    </ul>
                </nav>
            </div>
        </div>

        <footer class="site-footer">
            <p>
                Created and maintained by <br/>
                <a href="http://joshlockhart.com/">Josh Lockhart</a>,
                <a href="http://www.silentworks.co.uk/" target="_blank">Andrew Smith</a>,
                <a href="http://akrabat.com/" target="_blank">Rob Allen</a>, and the
                <a href="https://github.com/orgs/slimphp/people" target="_blank">Slim Framework Team</a>
            </p>
            <a alt="Donate with PayPal" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=HNUWP9UUGC7L4">Donate with PayPal</a>
        </footer>
    </div>
</div>
        
        
        
        
            
            
        
        
    




</body><!-- Mirrored from www.slimframework.com/docs/v3/features/csrf.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jun 2019 12:43:44 GMT --></html>