<!DOCTYPE html>
<html lang="en"><!-- Mirrored from www.slimframework.com/docs/v3/start/upgrade.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jun 2019 12:43:43 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

        <meta charset="utf-8"/>
        <meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport"/>
        <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
        <title>Upgrade Guide - Slim Framework</title>
        <meta content="" name="description"/>
        <meta content="index, follow" name="robots"/>
        <meta content="Upgrade Guide" property="og:title"/>
        <meta content="Slim Framework" property="og:site_name"/>
        <meta content="upgrade.html" property="og:url"/>
        <meta content="" property="og:description"/>
        <meta content="website" property="og:type"/>
        <!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
        <link href="../../../assets/css/all.css" rel="stylesheet"/>
        <link href="../../../assets/images/favicon.png" rel="shortcut icon"/>
        <link href="../../../../maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
        
        
        
    </head>
    <body style="padding-top: 5em">
        

<div class="wrapper docs">
    <div class="container-fluid">
        

        <div class="row">
            

            <div class="col-md-8 docs-content">
                <h1 class="page-header"><a class="dashAnchor" name="//apple_ref/cpp/Section/Upgrade%20Guide"></a>Upgrade Guide</h1>
                <div class="edit-panel" style="margin: 0 0 1em 0;">
                    <a class="btn btn-default btn-sm" href="https://github.com/slimphp/Slim-Website/tree/gh-pages/docs/v3/start/upgrade.md" role="button" target="_blank"><i class="fa fa-github"></i> Edit This Page</a>
                    
                </div>
                <p>If you are upgrading from version 2 to version 3, these are the significant changes that
you need to be aware of.</p>

<h2 id="new-php-version"><a class="dashAnchor" name="//apple_ref/cpp/Section/New%20PHP%20version"></a>New PHP version</h2>
<p>Slim 3 requires PHP 5.5+</p>

<h2 id="class-slimslim-renamed-slimapp"><a class="dashAnchor" name="//apple_ref/cpp/Section/Class%20%5CSlim%5CSlim%20renamed%20%5CSlim%5CApp"></a>Class \Slim\Slim renamed \Slim\App</h2>
<p>Slim 3 uses <code class="highlighter-rouge">\Slim\App</code> for the <a href="../objects/application.html">Application</a> object usually named <code class="highlighter-rouge">$app</code>.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Slim\App</span><span class="p">();</span>
</code></pre></div></div>

<h2 id="new-route-function-signature"><a class="dashAnchor" name="//apple_ref/cpp/Section/New%20Route%20Function%20Signature"></a>New Route Function Signature</h2>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Request</span> <span class="nv">$req</span><span class="p">,</span>  <span class="nx">Response</span> <span class="nv">$res</span><span class="p">,</span> <span class="nv">$args</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$res</span><span class="o">-&gt;</span><span class="na">withStatus</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'Bad Request'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="request-and-response-objects-are-no-longer-accessible-via-the-application-object"><a class="dashAnchor" name="//apple_ref/cpp/Section/Request%20and%20response%20objects%20are%20no%20longer%20accessible%20via%20the%20Application%20object"></a>Request and response objects are no longer accessible via the Application object</h2>
<p>As mentioned above, Slim 3 passes the <code class="highlighter-rouge">Request</code> and <code class="highlighter-rouge">Response</code> objects as arguments to the route handling function. Since they are now accessible directly in the body of a route function, <code class="highlighter-rouge">request</code> and <code class="highlighter-rouge">response</code> are no longer properties of the <code class="highlighter-rouge">/Slim/App</code> (<a href="../objects/application.html">Application</a> object) instance.</p>

<h2 id="getting-_get-and-_post-variables"><a class="dashAnchor" name="//apple_ref/cpp/Section/Getting%20_GET%20and%20_POST%20variables"></a>Getting _GET and _POST variables</h2>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Request</span> <span class="nv">$req</span><span class="p">,</span>  <span class="nx">Response</span> <span class="nv">$res</span><span class="p">,</span> <span class="nv">$args</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">{</span>
    <span class="nv">$myvar1</span> <span class="o">=</span> <span class="nv">$req</span><span class="o">-&gt;</span><span class="na">getParam</span><span class="p">(</span><span class="s1">'myvar'</span><span class="p">);</span> <span class="c1">//checks both _GET and _POST [NOT PSR-7 Compliant]
</span>    <span class="nv">$myvar2</span> <span class="o">=</span> <span class="nv">$req</span><span class="o">-&gt;</span><span class="na">getParsedBody</span><span class="p">()[</span><span class="s1">'myvar'</span><span class="p">];</span> <span class="c1">//checks _POST  [IS PSR-7 compliant]
</span>    <span class="nv">$myvar3</span> <span class="o">=</span> <span class="nv">$req</span><span class="o">-&gt;</span><span class="na">getQueryParams</span><span class="p">()[</span><span class="s1">'myvar'</span><span class="p">];</span> <span class="c1">//checks _GET [IS PSR-7 compliant]
</span><span class="p">});</span>
</code></pre></div></div>

<h2 id="hooks"><a class="dashAnchor" name="//apple_ref/cpp/Section/Hooks"></a>Hooks</h2>
<p>Hooks are no longer part of Slim as of v3.  You should consider reimplementing any functionality associated with the <a href="http://docs.slimframework.com/hooks/defaults/">default hooks in Slim v2</a> as <a href="../concepts/middleware.html">middleware</a> instead.  If you need the ability to apply custom hooks at arbitrary points in your code (for example, within a route), you should consider a third-party package such as <a href="http://symfony.com/doc/current/components/event_dispatcher/introduction.html">Symfony’s EventDispatcher</a> or <a href="https://zend-eventmanager.readthedocs.org/en/latest/">Zend Framework’s EventManager</a>.</p>

<h2 id="removal-http-cache"><a class="dashAnchor" name="//apple_ref/cpp/Section/Removal%20HTTP%20Cache"></a>Removal HTTP Cache</h2>
<p>In Slim v3 we have removed the HTTP-Caching into its own module <a href="https://github.com/slimphp/Slim-HttpCache">Slim\Http\Cache</a>.</p>

<h2 id="removal-of-stophalt"><a class="dashAnchor" name="//apple_ref/cpp/Section/Removal%20of%20Stop%2FHalt"></a>Removal of Stop/Halt</h2>
<p>Slim Core has removed Stop/Halt.
In your applications, you should transition to using the withStatus() and withBody() methods.</p>

<h2 id="removal-of-autoloader"><a class="dashAnchor" name="//apple_ref/cpp/Section/Removal%20of%20autoloader"></a>Removal of autoloader</h2>
<p><code class="highlighter-rouge">Slim::registerAutoloader()</code> have been removed, we have fully moved to composer.</p>

<h2 id="changes-to-container"><a class="dashAnchor" name="//apple_ref/cpp/Section/Changes%20to%20container"></a>Changes to container</h2>
<p><code class="highlighter-rouge">$app-&gt;container-&gt;singleton(...)</code> is now <code class="highlighter-rouge">$container = $app-&gt;getContainer(); $container['...'] = function () {};</code> Please read Pimple docs for more info</p>

<h2 id="removal-of-configuremode"><a class="dashAnchor" name="//apple_ref/cpp/Section/Removal%20of%20configureMode%28%29"></a>Removal of configureMode()</h2>
<p><code class="highlighter-rouge">$app-&gt;configureMode(...)</code> has been removed in v3.</p>

<h2 id="removal-of-prettyexceptions"><a class="dashAnchor" name="//apple_ref/cpp/Section/Removal%20of%20PrettyExceptions"></a>Removal of PrettyExceptions</h2>
<p>PrettyExceptions cause lots of issues for many people, so these have been removed.</p>

<h2 id="routesetdefaultconditions-has-been-removed"><a class="dashAnchor" name="//apple_ref/cpp/Section/Route%3A%3AsetDefaultConditions%28%E2%80%A6%29%20has%20been%20removed"></a>Route::setDefaultConditions(…) has been removed</h2>
<p>We have switched routers which enable you to keep the default conditions regex inside of the route pattern.</p>

<h2 id="changes-to-redirect"><a class="dashAnchor" name="//apple_ref/cpp/Section/Changes%20to%20redirect"></a>Changes to redirect</h2>
<p>In Slim v2.x one would use the helper function <code class="highlighter-rouge">$app-&gt;redirect();</code> to trigger a redirect request.
In Slim v3.x one can do the same with using the Response class like so.</p>

<p>Example:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="nv">$res</span><span class="p">,</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nv">$res</span><span class="o">-&gt;</span><span class="na">withStatus</span><span class="p">(</span><span class="mi">302</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">withHeader</span><span class="p">(</span><span class="s1">'Location'</span><span class="p">,</span> <span class="s1">'your-new-uri'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Alternatively, if you want a route to redirect without any other handling, you
can use the shortcut helper function <code class="highlighter-rouge">$app-&gt;redirect()</code> as the route
definition:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="s1">'your-new-uri'</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="middleware-signature"><a class="dashAnchor" name="//apple_ref/cpp/Section/Middleware%20Signature"></a>Middleware Signature</h2>
<p>The middleware signature has changed from a class to a function.</p>

<p>New signature:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">use</span> <span class="nx">Psr\Http\Message\RequestInterface</span> <span class="k">as</span> <span class="nx">Request</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Psr\Http\Message\ResponseInterface</span> <span class="k">as</span> <span class="nx">Response</span><span class="p">;</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">Request</span> <span class="nv">$req</span><span class="p">,</span>  <span class="nx">Response</span> <span class="nv">$res</span><span class="p">,</span> <span class="nx">callable</span> <span class="nv">$next</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Do stuff before passing along
</span>    <span class="nv">$newResponse</span> <span class="o">=</span> <span class="nv">$next</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="nv">$res</span><span class="p">);</span>
    <span class="c1">// Do stuff after route is rendered
</span>    <span class="k">return</span> <span class="nv">$newResponse</span><span class="p">;</span> <span class="c1">// continue
</span><span class="p">});</span>
</code></pre></div></div>

<p>You can still use a class:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="nx">My</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Psr\Http\Message\RequestInterface</span> <span class="k">as</span> <span class="nx">Request</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Psr\Http\Message\ResponseInterface</span> <span class="k">as</span> <span class="nx">Response</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Middleware</span>
<span class="p">{</span>
    <span class="k">function</span> <span class="nf">__invoke</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$req</span><span class="p">,</span>  <span class="nx">Response</span> <span class="nv">$res</span><span class="p">,</span> <span class="nx">callable</span> <span class="nv">$next</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Do stuff before passing along
</span>        <span class="nv">$newResponse</span> <span class="o">=</span> <span class="nv">$next</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="nv">$res</span><span class="p">);</span>
        <span class="c1">// Do stuff after route is rendered
</span>        <span class="k">return</span> <span class="nv">$newResponse</span><span class="p">;</span> <span class="c1">// continue
</span>    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// Register
</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">My\Middleware</span><span class="p">());</span>
<span class="c1">// or
</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nx">My\Middleware</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>

</code></pre></div></div>

<h2 id="middleware-execution"><a class="dashAnchor" name="//apple_ref/cpp/Section/Middleware%20Execution"></a>Middleware Execution</h2>
<p>Application middleware is executed as Last In First Executed (LIFE).</p>

<h2 id="flash-messages"><a class="dashAnchor" name="//apple_ref/cpp/Section/Flash%20Messages"></a>Flash Messages</h2>
<p>Flash messages are no longer a part of the Slim v3 core but instead have been moved to seperate <a href="../features/flash.html">Slim Flash</a> package.</p>

<h2 id="cookies"><a class="dashAnchor" name="//apple_ref/cpp/Section/Cookies"></a>Cookies</h2>
<p>In v3.0 cookies has been removed from core. See <a href="https://github.com/dflydev/dflydev-fig-cookies">FIG Cookies</a> for a PSR-7 compatible cookie component.</p>

<h2 id="removal-of-crypto"><a class="dashAnchor" name="//apple_ref/cpp/Section/Removal%20of%20Crypto"></a>Removal of Crypto</h2>
<p>In v3.0 we have removed the dependency for crypto in core.</p>

<h2 id="new-router"><a class="dashAnchor" name="//apple_ref/cpp/Section/New%20Router"></a>New Router</h2>
<p>Slim now utilizes <a href="https://github.com/nikic/FastRoute">FastRoute</a>, a new, more powerful router!</p>

<p>This means that the specification of route patterns has changed with named parameters now in braces and square brackets used for optional segments:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// named parameter:
</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/hello/{name}'</span><span class="p">,</span> <span class="cm">/*...*/</span><span class="p">);</span>

<span class="c1">// optional segment:
</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/news[/{year}]'</span><span class="p">,</span> <span class="cm">/*...*/</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="route-middleware"><a class="dashAnchor" name="//apple_ref/cpp/Section/Route%20Middleware"></a>Route Middleware</h2>
<p>The syntax for adding route middleware has changed slightly.
In v3.0:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="err">…</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$mw2</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$mw1</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="getting-the-current-route"><a class="dashAnchor" name="//apple_ref/cpp/Section/Getting%20the%20current%20route"></a>Getting the current route</h2>
<p>The route is an attribute of the Request object in v3.0:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getAttribute</span><span class="p">(</span><span class="s1">'route'</span><span class="p">);</span>
</code></pre></div></div>

<p>When getting the current route in middleware, the value for
<code class="highlighter-rouge">determineRouteBeforeAppMiddleware</code> must be set to <code class="highlighter-rouge">true</code> in the Application
configuration, otherwise the getAttribute call returns <code class="highlighter-rouge">null</code>.</p>

<h2 id="urlfor-is-now-pathfor-in-the-router"><a class="dashAnchor" name="//apple_ref/cpp/Section/urlFor%28%29%20is%20now%20pathFor%28%29%20in%20the%20router"></a>urlFor() is now pathFor() in the router</h2>

<p><code class="highlighter-rouge">urlFor()</code> has been renamed <code class="highlighter-rouge">pathFor()</code> and can be found in the <code class="highlighter-rouge">router</code> object:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">router</span><span class="o">-&gt;</span><span class="na">pathFor</span><span class="p">(</span><span class="s1">'home'</span><span class="p">);</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s2">"&lt;a href='</span><span class="nv">$url</span><span class="s2">'&gt;Home&lt;/a&gt;"</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
<span class="p">})</span><span class="o">-&gt;</span><span class="na">setName</span><span class="p">(</span><span class="s1">'home'</span><span class="p">);</span>
</code></pre></div></div>

<p>Also, <code class="highlighter-rouge">pathFor()</code> is base path aware.</p>

<h2 id="container-and-di--constructing"><a class="dashAnchor" name="//apple_ref/cpp/Section/Container%20and%20DI%20%E2%80%A6%20Constructing"></a>Container and DI … Constructing</h2>
<p>Slim uses Pimple as a Dependency Injection Container.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">// index.php
</span><span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Slim\App</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">\Slim\Container</span><span class="p">(</span>
        <span class="k">include</span> <span class="s1">'../config/container.config.php'</span>
    <span class="p">)</span>
<span class="p">);</span>

<span class="c1">// Slim will grab the Home class from the container defined below and execute its index method.
// If the class is not defined in the container Slim will still contruct it and pass the container as the first arugment to the constructor!
</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nx">Home</span><span class="o">::</span><span class="na">class</span> <span class="o">.</span> <span class="s1">':index'</span><span class="p">);</span>


<span class="c1">// In container.config.php
// We are using the SlimTwig here
</span><span class="k">return</span> <span class="p">[</span>
    <span class="s1">'settings'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'viewTemplatesDirectory'</span> <span class="o">=&gt;</span> <span class="s1">'../templates'</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">'twig'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'title'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
        <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
        <span class="s1">'author'</span> <span class="o">=&gt;</span> <span class="s1">''</span>
    <span class="p">],</span>
    <span class="s1">'view'</span> <span class="o">=&gt;</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$c</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Twig</span><span class="p">(</span>
            <span class="nv">$c</span><span class="p">[</span><span class="s1">'settings'</span><span class="p">][</span><span class="s1">'viewTemplatesDirectory'</span><span class="p">],</span>
            <span class="p">[</span>
                <span class="s1">'cache'</span> <span class="o">=&gt;</span> <span class="kc">false</span> <span class="c1">// '../cache'
</span>            <span class="p">]</span>
        <span class="p">);</span>

        <span class="c1">// Instantiate and add Slim specific extension
</span>        <span class="nv">$view</span><span class="o">-&gt;</span><span class="na">addExtension</span><span class="p">(</span>
            <span class="k">new</span> <span class="nx">TwigExtension</span><span class="p">(</span>
                <span class="nv">$c</span><span class="p">[</span><span class="s1">'router'</span><span class="p">],</span>
                <span class="nv">$c</span><span class="p">[</span><span class="s1">'request'</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">getUri</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">);</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="s1">'twig'</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$name</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$view</span><span class="o">-&gt;</span><span class="na">getEnvironment</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">addGlobal</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$value</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$view</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">Home</span><span class="o">::</span><span class="na">class</span> <span class="o">=&gt;</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$c</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Home</span><span class="p">(</span><span class="nv">$c</span><span class="p">[</span><span class="s1">'view'</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">];</span>

</code></pre></div></div>

<h2 id="psr-7-objects"><a class="dashAnchor" name="//apple_ref/cpp/Section/PSR-7%20Objects"></a>PSR-7 Objects</h2>

<h3 id="request-response-uri--uploadfile-are-immutable"><a class="dashAnchor" name="//apple_ref/cpp/Section/Request%2C%20Response%2C%20Uri%20%26%20UploadFile%20are%20immutable."></a>Request, Response, Uri &amp; UploadFile are immutable.</h3>
<p>This means that when you change one of these objects, the old instance is not updated.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// This is WRONG. The change will not pass through.
</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">,</span> <span class="nx">Response</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$next</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">withAttribute</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="s1">'def'</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$next</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// This is correct.
</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">,</span> <span class="nx">Response</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$next</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$request</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">withAttribute</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="s1">'def'</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$next</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="message-bodies-are-streams"><a class="dashAnchor" name="//apple_ref/cpp/Section/Message%20bodies%20are%20streams"></a>Message bodies are streams</h3>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...
</span><span class="nv">$image</span> <span class="o">=</span> <span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">'/huge_photo.jpg'</span><span class="p">;</span>
<span class="nv">$body</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Stream</span><span class="p">(</span><span class="nv">$image</span><span class="p">);</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="p">(</span><span class="k">new</span> <span class="nx">Response</span><span class="p">())</span>
     <span class="o">-&gt;</span><span class="na">withStatus</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s1">'OK'</span><span class="p">)</span>
     <span class="o">-&gt;</span><span class="na">withHeader</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">,</span> <span class="s1">'image/jpeg'</span><span class="p">)</span>
     <span class="o">-&gt;</span><span class="na">withHeader</span><span class="p">(</span><span class="s1">'Content-Length'</span><span class="p">,</span> <span class="nb">filesize</span><span class="p">(</span><span class="nv">$image</span><span class="p">))</span>
     <span class="o">-&gt;</span><span class="na">withBody</span><span class="p">(</span><span class="nv">$body</span><span class="p">);</span>
<span class="c1">// ...
</span></code></pre></div></div>

<p>For text:</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...
</span><span class="nv">$response</span> <span class="o">=</span> <span class="p">(</span><span class="k">new</span> <span class="nx">Response</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'Hello world!'</span><span class="p">)</span>

<span class="c1">// Or Slim specific: Not PSR-7 compliant.
</span><span class="nv">$response</span> <span class="o">=</span> <span class="p">(</span><span class="k">new</span> <span class="nx">Response</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'Hello world!'</span><span class="p">);</span>
<span class="c1">// ...
</span></code></pre></div></div>


                <nav>
                    <ul class="nav pager">
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                
                                    
                                        <li class="previous">
                                            <a href="installation.html" rel="prev"><i class="fa fa-arrow-left"></i> <small>Get Started: </small> Installation</a>
                                        </li>
                                    
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                
                                    <li class="next">
                                        <a href="web-servers.html" rel="next"><small>Get Started: </small> Web Servers <i class="fa fa-arrow-right"></i></a>
                                    </li>
                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                    </ul>
                </nav>
            </div>
        </div>

        <footer class="site-footer">
            <p>
                Created and maintained by <br/>
                <a href="http://joshlockhart.com/">Josh Lockhart</a>,
                <a href="http://www.silentworks.co.uk/" target="_blank">Andrew Smith</a>,
                <a href="http://akrabat.com/" target="_blank">Rob Allen</a>, and the
                <a href="https://github.com/orgs/slimphp/people" target="_blank">Slim Framework Team</a>
            </p>
            <a alt="Donate with PayPal" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=HNUWP9UUGC7L4">Donate with PayPal</a>
        </footer>
    </div>
</div>
        
        
        
        
            
            
        
        
    




</body><!-- Mirrored from www.slimframework.com/docs/v3/start/upgrade.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 19 Jun 2019 12:43:43 GMT --></html>